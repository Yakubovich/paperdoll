    <script type="text/javascript" src="jquery.min.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Uncial+Antiqua' rel='stylesheet' type='text/css'>
    <script>
      $(document).ready(function(){

        var names = {
          male: [ "Ralph", "Tony", "Archibald", "Seamus", "Julius", "Tanis", "Gordon", "Eddard", "Sam", "Robin", "Jack", "Oscar", "Ivan" ],
          female: [ "Ishtar", "Leah", "Anya", "Serena", "Alana", "Bella", "Alma", "Brynn", "Bianca", "Karina", "Jade", "Helena", "Ada", "Kathryn", "Kendra", "Louise", "Loretta", "Marcella", "Morgana", "Meredith", "Adelle", "Rita", "Zoey", "Sylvia" ],
          maleTitles: [ "Sir", "Lord", "Mister", "Prince", "Baron" ],
          femaleTitles: [ "Lady", "Miss", "Princess", "Baroness", "Madam" ],
          places: [ "Aldburg", "Argonath", "Carrock", "Dagorlad", "Dorwinion", "Eryn Vorn", "Harrowdale", "Silvermage" , "Coastedge" , "Mapleley" , "Cleardell" , "Magecastle" , "Southness" , "Colddell" , "Eriston" , "Mornesse" , "Southmerrow" , "Faybridge" , "Whitespell" , "Butteroak" , "Wintercrystal" , "Valford" , "Newwall" , "Faycrystal" , "Esterwell" , "Lochfair" , "Fairmage" , "Blueview" , "Byiron" , "Rosefog" , "Southbarrow" , "Faywald" , "Cliffbarrow" , "Marbleton" , "Bluebell" , "Whitebridge" , "Stonefox" , "Highville" , "Ironcliff" , "Blacksea" , "Spellmarsh" , "Crystalcastle" , "Fayhill" , "Dellhollow" , "Strongkeep" , "Sageshore" , "Fallwynne" , "Fallpond" , "Goldness" , "Summerston" , "Springbrook" , "Maplehurst" , "Freyley" , "Glassland" , "Jancastle" , "Summerpond" , "Stonehaven" , "Snowbay" , "Faymont" , "Bluegrass" , "Lochcrystal" , "Seacoast" , "Eriwynne" , "Landwick" , "Valnesse" , "Highdale" , "Brightview" , "Morland" , "Deerbeach" , "Osthedge" , "Valbridge" , "Havencoast" , "Butternesse" , "Silverbourne" , "Winterhedge" , "Beachmoor" , "Normount" , "Magefield" , "Springlight" , "Coldriver" , "Clearsummer" , "Morlake" , "Pinehedge" , "Fallgold" , "Clearlake" , "Newwynne" , "Wheatholt" , "Lochcastle" ], 
          adj : [ "Merry", "Noble", "Notorious", "Infamous", "Mysterious", "Pious", "Old Fashioned", "Glamorous", "Red", "Yellow", "Blue", "Gray", "Golden", "Black", "Fierce", "Brave", "Proud", "Zealous", "Exotic", "Drunken", "Dark", "Elite", "Secret", "Wholesome", "Vengeful" ],
          group: [ "Band", "Party", "Group", "Company", "Bunch", "Pack", "Gang", "Adventurers", "Companions", "Marauders", "Brigands", "Clan", "Seekers", "Militia", "Entourage" ]
        };

        var femaleSprites = {
          body: {
            "black" : "sprite_0122_black-female.png",
            "white" : "sprite_0123_white-female.png",
          },
          pants: {
            "leather" : "sprite_0102_leather-pants-female.png",
            "dragonscale" : "sprite_0104_dragonscale-pants-(female).png",
            "elven" : "sprite_0106_elven-pants-(female).png",
            "goldenfleece" : "sprite_0108_goldenfleece-pants-(female).png",
            "chain" : "sprite_0110_chain-pants-(female)-copy.png",
          },
          hair: {
            "blonde" : "sprite_0008_female-hair-1-blonde.png",
            "black" : "sprite_0009_female-hair-1-black.png",
            "brown" : "sprite_0010_female-hair-1-brown.png",
            "brown2" : "sprite_0011_female-hair-2-brown.png",
            "grey" : "sprite_0012_female-hair-2-grey.png",
            "red" : "sprite_0013_female-hair-1-red.png",
            "white" : "sprite_0014_female-hair-1-white.png",
            "grey" : "sprite_0015_female-hair-1-grey.png",
          },
          face: {
            "face" : "sprite_0116_female-face-1-black.png",
            //"sprite_0117_female-face-1.png",
          },
          chest: {
            "studded" : "sprite_0086_studded-leather-armour-(female).png",
            "leather" : "sprite_0087_leather-armour-(female).png",
            "rusty" : "sprite_0093_rusty-chain-body-(female).png",
            "goldenfleece" : "sprite_0095_goldenfleece-body-(female).png",
            "chain" : "sprite_0098_chain-body-(female).png",
            "goo" : "sprite_0100_goo-(female).png",
            "white" : "sprite_0055_white-robes-female.png",
            "sorcerer" : "sprite_0056_sorcerer-robe-female.png",
            "regal" : "sprite_0058_regal-robe-female.png",
            "fur" : "sprite_0061_fur-robe-female.png",
            "ice" : "sprite_0062_ice-robe-female.png",
            "simple" : "sprite_0066_simple-robe-female.png",
            "witch2" : "sprite_0067_witch-dress2.png",
            "witch" : "sprite_0068_witch-dress1.png",
            "knight" : "sprite_0069_knight-armour-female.png",
          },
        };
        var sprites = {
          cape: {
            "hero" : "sprite_0126_hero-cape.png",
            "travel" : "sprite_0127_travel-cape.png",
            "blue" : "sprite_0128_blue-cape.png",
            "black" : "sprite_0129_black-cape.png",
            "red" : "sprite_0130_red-cape.png"
          },
          body: {
            "orc" : "sprite_0119_orc-body.png",
            "red" : "sprite_0120_red-body.png",
            "black" : "sprite_0121_black-body.png",
            "white" : "sprite_0124_white-body.png"
          },
          pants: {
            "knight" : "sprite_0084_knight-pants.png",
            "leather" : "sprite_0103_leather-pants.png",
            "dragonscale" : "sprite_0105_dragonscale-pants.png",
            "elven" : "sprite_0107_elven-pants.png",
            "goldenfleece" : "sprite_0109_goldenfleece-pants.png",
            "chain" : "sprite_0111_chain-pants.png"
          },
          hair: {
            "long blond" : "sprite_0016_long-hair-blond.png",
            "long" : "sprite_0017_long-hair.png",
            "short" : "sprite_0018_short-hair.png"
          },
          face: {
            "face3" : "sprite_0112_face3.png",
            "orc" : "sprite_0113_orc-face-1.png",
            "red" : "sprite_0114_red-face-1.png",
            "face2" : "sprite_0115_face2.png",
            "face1" : "sprite_0118_face1.png"
          },
          boots: {
            "elven" : "sprite_0076_elven-boots.png",
            "northern" : "sprite_0077_northern-boots.png",
            "golden" : "sprite_0078_golden-boots.png",
            "knight" : "sprite_0079_knight-boots.png",
            "steel" : "sprite_0080_steel-workboots.png",
            "work" : "sprite_0081_workboots.png",
            "combat" : "sprite_0082_combat-boots.png",
            "leather" : "sprite_0083_leather-boots.png"
          },
          gloves: {
            "knight" : "sprite_0073_knight-gloves.png",
            "golden" : "sprite_0074_golden-gloves.png",
            "leather" : "sprite_0075_leather-gloves.png"
          },
          chest: {
            "studded" : "sprite_0085_studded-leather-armour.png",
            "leather" : "sprite_0088_leather-armour.png",
            "elven" : "sprite_0089_elven-breasplate.png",
            "gold2" : "sprite_0090_merzul-breastplate.png",
            "gold" : "sprite_0091_gold-breastplate.png",
            "rusty" : "sprite_0092_rusty-chain-body.png",
            "dragonscale" : "sprite_0094_dragonscale-body.png",
            "goldenfleece" : "sprite_0096_goldenfleece-body.png",
            "elven2" : "sprite_0097_elven-chainmail-(incomplete).png",
            "chain" : "sprite_0099_chain-body.png",
            "goo" : "sprite_0101_goo.png",
            "white robes" : "sprite_0052_white-robes1.png",
            "desert" : "sprite_0053_desert-wizard-clothes.png",
            "sorcerer robes" : "sprite_0054_robes-of-the-sorcerer.png",
            "regal" : "sprite_0057_regal-robe.png",
            "northern" : "sprite_0059_northern-coat.png",
            "fur" : "sprite_0060_fur-robe.png",
            "ice" : "sprite_0063_ice-robe.png",
            "druid" : "sprite_0064_druid's-robe.png",
            "simple" : "sprite_0065_simple-robe.png",
            "knight armour" : "sprite_0070_knight-armour.png",
            "knight breastplate" : "sprite_0071_knight-breastplate.png"
          },
          weapon: {
            "dwarven" : "sprite_0026_dwarven-sword.png",
            "short sword" : "sprite_0027_short-sword.png",
            "long sword" : "sprite_0028_longsword.png",
            "bastard sword" : "sprite_0029_bastard-sword.png",
            "two handed sword" : "sprite_0030_two-hand-sword.png",
            "cutlass" : "sprite_0031_royal-cutlass1.png",
            "cutlass2" : "sprite_0032_nederianese-cutlass.png",
            "rapier" : "sprite_0033_rapier.png",
            "officer" : "sprite_0034_ornamental-officer-sword.png",
            "flail" : "sprite_0035_black-flail.png",
            "flail2" : "sprite_0036_flail.png",
            "morning star" : "sprite_0037_morning-star.png",
            "mace" : "sprite_0038_rounded-mace.png",
            "knife" : "sprite_0039_kitchen-knife.png",
            "curved dirk" : "sprite_0040_curved-dirk.png",
            "throwing knife" : "sprite_0041_throwing-knife.png",
            "dirk" : "sprite_0042_dirk.png",
            "hunting knife" : "sprite_0043_hunting-knife.png",
            "scythe" : "sprite_0044_war-scyhe.png",
            "staff" : "sprite_0045_quarter-staff.png",
            "staff2" : "sprite_0046_staff.png",
            "club" : "sprite_0047_wooden-club.png",
            "ceremonial" : "sprite_0048_ceremonial-dagger.png",
            "dagger" : "sprite_0049_dagger.png",
            "thin sword" : "sprite_0050_thin-sword.png"
          },
          beard: {
            "small beard blond" : "sprite_0000_small-beard-blond.png",
            "small beard grey" : "sprite_0001_small-beard-grey.png",
            "white beard" : "sprite_0002_white-beard.png",
            "square white beard" : "sprite_0003_square-white-beard.png",
            "square grey beard" : "sprite_0004_square-beard-grey.png",
            "grey beard" : "sprite_0005_grey-beard.png",
            "black evil beard" : "sprite_0019_black-evil-beard.png",
            "evil beard" : "sprite_0020_evil-beard.png",
            "black beard" : "sprite_0021_black-beard.png",
            "brown beard" : "sprite_0022_brown-beard.png",
          },
          hat: {
            "turban" : "sprite_0006_turban.png",
            "adventuring" : "sprite_0007_adventuring-hat.png",
            "large horned" : "sprite_0023_large-horned-helm.png",
            "horned" : "sprite_0024_horned-helm.png",
            "large" : "sprite_0025_large-helmet.png"
          }
        };

        loadImages(sprites);
        loadImages(femaleSprites);
        roll();


        $("#roll").click(roll);

        function roll() {

          $("#chars").html("");
          $("#names").html("");

          var chars = Math.floor(Math.random() * 8) + 1;

          if (chars > 3) 
            $("#names").html(generateGroup());

          var uniform = null;

          if (Math.random() > 0.9) {
            uniform = { "hat" : "turban", "chest": "desert" };
          } else if (Math.random() > 0.99) {
            uniform = { "pants" : "goldenfleece", "chest": "goldenfleece", "boots": "golden", "gloves": "golden" };
          } else if (Math.random() > 0.9) {
            uniform = { "pants" : "leather", "chest": "rusty", "body": "orc", "boots": "work", "chest": "rusty" };
          }

          
          for (var i = 0; i < chars; i++) {
            var female = Math.random() > 0.5;
            addChar(female, uniform);
            if (i == chars - 1 && chars <= 3 && chars > 1)
              $("#names").append("and ");
            if (chars <= 3)
              $("#names").append(generateName(female) + "<br>");
          }
          $(".character").delay(200).addClass("clear");
        }

        function generateName(female) {
          var title = "", place = "";
          var firstName = female ? pickOne(names.female) : pickOne(names.male);
          if (Math.random() > 0.6)
            title = female ? pickOne(names.femaleTitles) + " " : pickOne(names.maleTitles) + " ";
          if (Math.random() > 0.6)
            place = " " + pickOne(["from","of"]) + " " + pickOne(names.places);
          else if (Math.random() > 0.6)
            place = " the " + pickOne(names.adj);

          return title + firstName + place;
        }

        function generateGroup() {
          return "The " + pickOne(names.adj) + " " + pickOne(names.group);
        }

        function pickOne(from) {
          //return from[Math.floor(Math.random() * from.length)];
          var count = 0;
          for (var prop in from) {
              if (count == 0)
                result = prop;
              if (Math.random() < 1/++count) {
                 result = prop; 
              }
          }
          return from[result];
        }

        function addChar(female, uniform) {
          var $char = $("<div>").addClass("character");
          var img;
          var group;
          for (var i in sprites) {

            if (female && ((i == "body") || (i == "pants") || (i == "hair") || (i == "face") || (i == "chest")))
              group = femaleSprites;
            else
              group = sprites;

            if (uniform != null && uniform.hasOwnProperty(i))
              img = typeof group[i][uniform[i]] !== "undefined" ? group[i][uniform[i]] : pickOne(group[i]);
            else
              img = pickOne(group[i]);


            if (!(female && i == "beard"))
              if ($.inArray(i, ["beard", "hat", "weapon", "cape", "boots", "gloves"]) < 0 || Math.random() > 0.5)
                $char.append($(img).clone().css("z-index", i));
          }
          $char.appendTo($("#chars"));
        }

        function loadImages(sprites) {
          for (var i in sprites) {
            for (var j in sprites[i]) {
              var path = "sprite/" + i + "/" + sprites[i][j];
              sprites[i][j] = new Image();
              sprites[i][j].src = path;
            }
          }
        }
      });
    </script>
    <style>
      body {
        background: #111;
        text-align: center;
        padding-top: 100px;
      }
      h1 { 
        text-align: center;
        font-family: 'Uncial Antiqua', cursive;
        color: #94826B;
        text-shadow: 2px 2px #443A2D;
      }
      #names {
        text-align: center;
        margin-bottom: 50px;
        font-family: 'Uncial Antiqua', cursive;
        font-size: 24px;
        color: #94826B;
        text-shadow: 2px 2px #443A2D;
      }
      .character {
        display: inline-block;
        position: relative;
        width: 76px;
        height: 157px;
        margin-left: -15;
        margin-right: -15;
        -webkit-transition: all 2s;
        -webkit-filter: blur(4px);
      }
      .character.clear {
        -webkit-transition: all 2s;
        -webkit-filter: blur(0px);
      }
      .character img {
        position: absolute;
        top:0;
        left:0;
      }
      #roll {
        font-family: 'Uncial Antiqua', cursive;
        font-size: 14px;
        background: #94826B;
        text-shadow: 1px 1px rgba(255,255,255,.7);
        margin-top: 30px;
      }
    </style>
  </head>
  <body>
    <h1>You encounter...</h1>
    <div id="names"></div>
    <div id="chars"></div>
    <button id="roll">Roll Another</button>
    <a href="https://github.com/yakubovich/paperdoll"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_white_ffffff.png" alt="Fork me on GitHub"></a>
  </body>
</html>
